<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trend Compass - AI-Powered Trend Forecasting</title>
    
    <!-- Enhanced Stylesheets with New Theme -->
    <link rel="stylesheet" href="css/enhanced-theme.css" />
    
    <!-- External Resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />
    
    <!-- SEO and Performance -->
    <meta name="description" content="Next-generation AI-powered trend forecasting and cultural insights platform combining Qloo's data with Gemini LLM." />
    <meta name="keywords" content="trend forecasting, AI insights, cultural data, audience analysis" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ”®</text></svg>" />
</head>
<body>
    <!-- Main Application Container -->
    <div class="container">
        <!-- Enhanced Header with API Status -->
        <header class="header">
            <h1 class="gradient-text">Trend Compass</h1>
            <p class="subtitle">Next-Gen AI-Powered Trend Forecasting & Cultural Insights</p>
            
            <!-- API Status Indicator -->
            <div id="apiStatus" class="api-status">
                <span class="status-indicator status-warning"></span>
                <span>Checking API status...</span>
            </div>
            
            <!-- Test Button for Export/Save Functions -->
            <!-- <div id="testControls" class="test-controls" style="display: none;">
                <button onclick="setupTestDataAndShow()" class="btn-test">
                    ðŸ§ª Test Export/Save Functions
                </button>
            </div> -->
            
            <!-- Server Status Banner (hidden by default) -->
            <div id="serverStatusBanner" class="server-status-banner d-none">
                <div class="banner-content">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Server connection issue detected. This could be due to the server being down or rate limits exceeded (15 requests per day).</span>
                    <button onclick="checkApiStatus()" class="btn-retry">
                        <i class="fas fa-sync-alt"></i> Retry Connection
                    </button>
                </div>
            </div>
            
            <!-- Enhanced Navigation -->
            <nav class="nav-tabs">
                <button class="tab-button active neomorphic-hover transition-all" data-tab="trend-tab">
                    <i class="fas fa-chart-line"></i>
                    <span>Trend Analysis</span>
                </button>
                <button class="tab-button neomorphic-hover transition-all" data-tab="audience-tab">
                    <i class="fas fa-users"></i>
                    <span>Audience Insights</span>
                </button>
                <button class="helper-btn neomorphic-hover transition-all" onclick="showHelperMenu(this)">
                    <i class="fas fa-magic"></i>
                    <span>Helper Tools</span>
                </button>
            </nav>
        </header>
                
        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Trend Analysis Tab -->
            <div id="trend-tab" class="tab-content active">
                <section class="card interactive-card hover-lift">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="card-info">
                            <h2>Trend Analysis</h2>
                            <p>Discover emerging trends and forecast their cultural impact with AI-powered insights</p>
                        </div>
                        <div class="rate-limit-box" id="trendRateLimit">
                            <i class="fas fa-chart-bar"></i>
                            <span>Daily quota: 15 requests available</span>
                        </div>
                    </div>
                    
                    <form id="trendForm" class="glass-form">
                        <div class="input-group">
                            <label class="input-label icon-text">
                                <i class="fas fa-search"></i>
                                <span>What trend would you like to analyze?</span>
                            </label>
                            <div class="input-row">
                                <div class="input-container">
                                    <input 
                                        type="text" 
                                        id="trendQuery" 
                                        class="input-field transition-all"
                                        placeholder="e.g., Plant-based meat alternatives, Sustainable fashion, Remote work culture..."
                                        required
                                        autocomplete="off"
                                        maxlength="200"
                                        minlength="3"
                                    />
                                    <div class="character-count">
                                        <span id="trendCharCount">0</span>/200 characters
                                    </div>
                                    <div class="validation-message" id="trendValidation"></div>
                                </div>
                                <button type="submit" class="btn btn-primary submit-button neomorphic-hover transition-all">
                                    <i class="fas fa-magic"></i>
                                    <span>Analyze Trend</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Optional Advanced Inputs -->
                        <div class="advanced-inputs" style="display: none;">
                            <div class="input-group">
                                <label class="input-label">
                                    <i class="fas fa-industry"></i>
                                    <span>Industry (Optional)</span>
                                </label>
                                <input 
                                    type="text" 
                                    id="trendIndustry" 
                                    class="input-field"
                                    placeholder="e.g., Fashion, Technology, Food & Beverage"
                                />
                            </div>
                            <div class="input-group">
                                <label class="input-label">
                                    <i class="fas fa-clock"></i>
                                    <span>Timeframe (Optional)</span>
                                </label>
                                <select id="trendTimeframe" class="input-field">
                                    <option value="">Select timeframe</option>
                                    <option value="3 months">3 months</option>
                                    <option value="6 months">6 months</option>
                                    <option value="1 year">1 year</option>
                                    <option value="2 years">2 years</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="button" class="btn-link" onclick="toggleAdvancedInputs('trend')">
                            <i class="fas fa-cog"></i> Advanced Options
                        </button>
                    </form>
                    
                    <!-- Loading State -->
                    <div id="trendLoading" class="loading-overlay d-none">
                        <div class="loading-spinner"></div>
                    </div>
                    
                    <!-- Results Container with Export -->
                    <div id="trendResults" class="results-section d-none">
                        <div class="results-container">
                            <div class="results-header">
                                <i class="fas fa-brain text-accent"></i>
                                <h3>AI Analysis Results</h3>
                                <div class="results-actions">
                                    <button class="btn btn-export-json" onclick="exportResults('trend', 'json')">
                                        <i class="fas fa-download"></i> Export JSON
                                    </button>
                                    <button class="btn btn-export-csv" onclick="exportResults('trend', 'csv')">
                                        <i class="fas fa-file-csv"></i> Export CSV
                                    </button>
                                    <button class="btn btn-save-insight" onclick="saveInsight('trend')">
                                        <i class="fas fa-bookmark"></i> Save Insight
                                    </button>
                                </div>
                            </div>
                            <div class="results-content" id="trendResultsContent">
                                <!-- Results will be populated here -->
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Audience Insights Tab -->
            <div id="audience-tab" class="tab-content">
                <section class="card interactive-card hover-lift">
                    <div class="card-header">
                        <div class="card-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="card-info">
                            <h2>Audience Insights</h2>
                            <p>Understand your target audience through deep cultural affinity analysis</p>
                        </div>
                        <div class="rate-limit-box" id="audienceRateLimit">
                            <i class="fas fa-chart-bar"></i>
                            <span>Daily quota: 15 requests available</span>
                        </div>
                    </div>
                    
                    <form id="audienceForm" class="glass-form">
                        <div class="input-group">
                            <label class="input-label icon-text">
                                <i class="fas fa-user-friends"></i>
                                <span>Describe your target audience</span>
                            </label>
                            <div class="input-row">
                                <div class="input-container">
                                    <textarea 
                                        id="audienceDescription" 
                                        class="input-field textarea-field transition-all"
                                        placeholder="e.g., Tech-savvy millennials interested in sustainable living, Gen Z fashion enthusiasts, health-conscious professionals..."
                                        required
                                        maxlength="500"
                                        minlength="10"
                                    ></textarea>
                                    <div class="character-count">
                                        <span id="audienceCharCount">0</span>/500 characters
                                    </div>
                                    <div class="validation-message" id="audienceValidation"></div>
                                </div>
                                <button type="submit" class="btn btn-primary submit-button neomorphic-hover transition-all">
                                    <i class="fas fa-search-plus"></i>
                                    <span>Analyze Audience</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Optional Advanced Inputs -->
                        <div class="advanced-inputs" style="display: none;">
                            <div class="input-group">
                                <label class="input-label">
                                    <i class="fas fa-tag"></i>
                                    <span>Product Category (Optional)</span>
                                </label>
                                <input 
                                    type="text" 
                                    id="audienceCategory" 
                                    class="input-field"
                                    placeholder="e.g., Beauty, Tech gadgets, Fitness products"
                                />
                            </div>
                            <div class="input-group">
                                <label class="input-label">
                                    <i class="fas fa-globe"></i>
                                    <span>Region (Optional)</span>
                                </label>
                                <select id="audienceRegion" class="input-field">
                                    <option value="">Select region</option>
                                    <option value="North America">North America</option>
                                    <option value="Europe">Europe</option>
                                    <option value="Asia">Asia</option>
                                    <option value="South America">South America</option>
                                    <option value="Africa">Africa</option>
                                    <option value="Oceania">Oceania</option>
                                    <option value="Global">Global</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="button" class="btn-link" onclick="toggleAdvancedInputs('audience')">
                            <i class="fas fa-cog"></i> Advanced Options
                        </button>
                    </form>
                    
                    <!-- Loading State -->
                    <div id="audienceLoading" class="loading-overlay d-none">
                        <div class="loading-spinner"></div>
                    </div>
                    
                    <!-- Results Container with Export -->
                    <div id="audienceResults" class="results-section d-none">
                        <div class="results-container">
                            <div class="results-header">
                                <i class="fas fa-chart-pie text-accent"></i>
                                <h3>Audience Analysis Results</h3>
                                <div class="results-actions">
                                    <button class="btn btn-export-json" onclick="exportResults('audience', 'json')">
                                        <i class="fas fa-download"></i> Export JSON
                                    </button>
                                    <button class="btn btn-export-csv" onclick="exportResults('audience', 'csv')">
                                        <i class="fas fa-file-csv"></i> Export CSV
                                    </button>
                                    <button class="btn btn-save-insight" onclick="saveInsight('audience')">
                                        <i class="fas fa-bookmark"></i> Save Insight
                                    </button>
                                </div>
                            </div>
                            <div class="results-content" id="audienceResultsContent">
                                <!-- Results will be populated here -->
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Error/Success Message Container -->
    <div id="messageContainer" class="fixed top-4 right-4 z-50 d-none">
        <!-- Dynamic messages will be inserted here -->
    </div>

    <!-- JavaScript -->
    <script src="js/app.js"></script>
</body>
</html>
